# cpp-extra-samples

This repository contains  **C++** code samples for **Zivid**.

[![Build Status][ci-badge]][ci-url]

Check out our [tutorial on configuring and building these samples on Ubuntu](https://zivid.atlassian.net/wiki/spaces/ZividKB/pages/59441336/Configure+C+Samples+with+CMake+and+then+build+them+using+make+in+Ubuntu).

## Samples list

There are two main categories of samples: **Camera** and **Applications**. The samples in the **Camera** category focus only on how to use the camera. The samples in the **Applications** category use the output generated by the camera, such as the 3D point cloud, a 2D image or other data from the camera. These samples shows how the data from the camera can be used.

- **Camera**
  - **基础** ([quick tutorial][QuickCaptureTutorial-url] / [complete tutorial][CompleteCaptureTutorial-url])
    - [**Capture**][Capture-url] - 这个例子演示了如何从Zivid相机获取图像.
    - [**Capture2D**][Capture2D-url] - 这个例子演示了如何只从Zivid相机获取2D图像.
    - [**CaptureAssistant**][CaptureAssistant-url] - 这个例子演示了如何使用Capture Assistant从Zivid相机获取HDR图像.
    - [**CaptureFromFile**][CaptureFromFile-url] - 这个例子展示了如何从文件中获取HDR图像。这个示例可以在不使用物理相机的情况下使用.
    - [**CaptureHDR**][CaptureHDR-url] - 这个例子演示了如何从Zivid相机获取HDR图像.
    - [**CaptureHDRCompleteSettings**][CaptureHDRCompleteSettings-url] - 这个示例展示了如何从Zivid相机获取HDR图像，并为每一帧设置了完整的设置.
    - [**CaptureHDRLoop**][CaptureHDRLoop-url] - 这个例子演示了如何在循环中从Zivid相机获取HDR图像，并使用.yml文件中的设置.
  - **基础设施**
    - [**CameraUserData**][CameraUserData-url] - 这个例子展示了如何在Zivid相机上存储用户数据.
    - [**GetCameraIntrinsics**][GetCameraIntrinsics-url] - 这个例子展示了如何从Zivid相机中获取相机的内部特性.
    - [**FirmwareUpdater**][FirmwareUpdater-url] - 这个例子展示了如何使用Zivid api来更新Zivid相机上的固件.

- **Applications**
  - **基本**
    - **可视化**
      - [**CaptureFromFileVis3D**][CaptureFromFileVis3D-url] - 这个例子展示了如何从文件中捕获一个Zivid点云，并将其可视化。.
      - [**CaptureVis3D**][CaptureVis3D-url] - 这个例子展示了如何捕获一个Zivid点云，并将其可视化.
      - [**CaptureLiveVis3D**][CaptureLiveVis3D-url] - 这个例子演示了如何连续捕获一个Zivid点云，并将其可视化.
      - [**CaptureWritePCLVis3D**][CaptureWritePCLVis3D-url] - 这个示例展示了如何捕获Zivid点云，将其保存为.PCD文件格式，并将其可视化.
      - [**ReadPCLVis3D**][ReadPCLVis3D-url] - 这个示例展示了如何读取PCL点云并将其可视化.
    - **文件格式**
      - [**ReadIterateZDF**][ReadIterateZDF-url] - 这个例子展示了如何从. zdf文件中导入一个Zivid点云，迭代并提取单独的点.
  - **高级**
    - [**HandEyeCalibration**][HandEyeCalibration-url]
      - [**HandEyeCalibration**][HandEyeCalibrationSample-url] - 这个样本显示了如何执行一个完整的手眼校准.
      - [**UtilizeEyeInHandCalibration**][UtilizeEyeInHandCalibration-url] - 使用手眼校准矩阵将3D点从摄像机框架转换到机器人基础框架.
      - [**PoseConversions**][PoseConversions-url] - 变换矩阵(旋转矩阵+平移向量).
    - [**Downsample**][Downsample-url]  - 这个例子演示了如何从.ZDF文件中导入一个Zivid点云，并对它进行向下采样.
      - **依赖:**
        - [Eigen](http://eigen.tuxfamily.org/) version 3.3.7 or newer
    - [**CaptureUndistortRGB**][CaptureUndistortRGB-url] - 使用Zivid相机内建来还原RGB图像. 此示例将提示用户是否捕获2D或3D图像. 在这两种情况下，它都将对2D图像进行操作. 但是，在3D情况下，它将从ZDF点云提取2D图像. 2D版本更快.
      - **依赖:**
        - [OpenCV](https://opencv.org/) version 4.0.1 or newer
    - [**CreateDepthMap**][CreateDepthMap-url] - 导入一个ZDF点云并将其转换为OpenCV格式，然后提取深度图并将其可视化.
      - **依赖:**
        - [OpenCV](https://opencv.org/) version 4.0.1 or newer

## 指令说明

[**Install Zivid Software**](https://zivid.atlassian.net/wiki/spaces/ZividKB/pages/59080712/Zivid+Software+Installation).
Note: The version tested with Zivid cameras is 1.8.0.

### Windows

按键盘上的*Win + R*键启动命令提示符，然后输入cmd并回车.

导航到要克隆存储库的位置，然后运行以下命令:

```bash
git clone https://github.com/zivid/cpp-extra-samples
```

[comment]: <> (选择一个示例解决方案，并使用CMake配置它.)
[comment]: <> (启动Visual Studio，打开、构建并运行示例解决方案.)

使用CMake配置示例解决方案，在Visual Studio中打开它，构建它，运行它. 如果您对此不确定，请参阅我们的配置教程 [**C++ Extra Samples**](https://zivid.atlassian.net/wiki/spaces/ZividKB/pages/61472793/Configure+C+Extra+Samples+with+CMake+and+build+them+using+Visual+Studio+in+Windows) 使用CMake并在Windows中使用Visual Studio来构建它们.

#### Ubuntu

按键盘上的*Ctrl + Alt + T*键打开终端.

导航到要克隆存储库的位置，然后运行以下命令:

```bash
git clone https://github.com/zivid/cpp-extra-samples
cd cpp-extra-samples
```

构建项目:

```bash
mkdir build
cd build
cmake <options, see below> ../source
make -j
```

一些示例依赖于外部库，特别是Eigen 3、OpenCV或PCL. 如果不想安装它们，可以通过传递以下选项禁用依赖于它们的示例, 分别`cmake`: `-DUSE_EIGEN3=OFF`, `-DUSE_OPENCV=OFF`, `-DUSE_PCL=OFF`.

如果你想使用它们:

- **Eigen 3**: 设置 `-DEIGEN3_INCLUDE_DIR=<path>`. 其中`<path>` 是Eigen3 安装的根目录(包括 Eigen/Core, Eigen/Dense等文件夹).
- **PCL** and **OpenCV**: 如果您的系统上安装了足够的最新版本，这些应该可以正常工作. 如果不行, 设置 `-DPCL_DIR=<path>` / `-DOpenCV_DIR=<path>`. 其中 `<path>`是分别包含`PCLConfig.cmake` and `OpenCVConfig.cmake`.

样例现在可以从' build '目录运行，例如这样:

```bash
./CaptureFromFileVis3D
```

## 支持

如果你需要使用Zivid相机的帮助, 参见 [**Knowledge Base**](https://help.zivid.com/) 或者联系我们 [customersuccess@zivid.com](mailto:customersuccess@zivid.com).

## 证书

Zivid Samples are distributed under the [BSD license](LICENSE).

## 开发

在本地运行持续集成, 使用 [Docker](https://www.docker.com). 安装Docker后，运行此命令:

```bash
docker run -it -v <unixy-repo-path>:/host -w /host/continuous-integration/linux ubuntu:18.04
```

Where `<unixy-repo-path>` is the unixy path to the repo on your computer. On Linux, use `$PWD` for this. On Windows you need to translate the windowsy path to a unixy one (e.g. `/c/Users/alice/Documents/cpp-extra-samples`).

Now run `./setup.sh` to install dependencies. Once setup has completed, you can run `./lint.sh && ./build.sh` repeatedly to check your code.

Tip: If your build hangs, try to increase the memory available to Docker.

[ci-badge]: https://img.shields.io/azure-devops/build/zivid-devops/5e76c4a5-26ad-4cbb-8ab5-b9588e1ed2b2/4
[ci-url]: https://dev.azure.com/zivid-devops/cpp-extra-samples/_build/latest?definitionId=4&branchName=master
[QuickCaptureTutorial-url]: source/Camera/Basic/QuickCaptureTutorial.md
[CompleteCaptureTutorial-url]: source/Camera/Basic/CaptureTutorial.md
[Capture-url]: source/Camera/Basic/Capture/Capture.cpp
[Capture2D-url]: source/Camera/Basic/Capture2D/Capture2D.cpp
[CaptureAssistant-url]: source/Camera/Basic/CaptureAssistant/CaptureAssistant.cpp
[CaptureFromFile-url]: source/Camera/Basic/CaptureFromFile/CaptureFromFile.cpp
[CaptureHDR-url]: source/Camera/Basic/CaptureHDR/CaptureHDR.cpp
[CaptureHDRLoop-url]: source/Camera/Basic/CaptureHDRLoop/CaptureHDRLoop.cpp
[CaptureHDRCompleteSettings-url]: source/Camera/Basic/CaptureHDRCompleteSettings/CaptureHDRCompleteSettings.cpp
[CameraUserData-url]: source/Camera/InfoUtilOther/CameraUserData/CameraUserData.cpp
[GetCameraIntrinsics-url]: source/Camera/InfoUtilOther/GetCameraIntrinsics/GetCameraIntrinsics.cpp
[FirmwareUpdater-url]: source/Camera/InfoUtilOther/FirmwareUpdater/FirmwareUpdater.cpp
[CaptureFromFileVis3D-url]: source/Applications/Basic/Visualization/CaptureFromFileVis3D/CaptureFromFileVis3D.cpp
[CaptureVis3D-url]: source/Applications/Basic/Visualization/CaptureVis3D/CaptureVis3D.cpp
[CaptureLiveVis3D-url]: source/Applications/Basic/Visualization/CaptureLiveVis3D/CaptureLiveVis3D.cpp
[CaptureWritePCLVis3D-url]: source/Applications/Basic/Visualization/CaptureWritePCLVis3D/CaptureWritePCLVis3D.cpp
[ReadPCLVis3D-url]: source/Applications/Basic/Visualization/ReadPCLVis3D/ReadPCLVis3D.cpp
[ReadIterateZDF-url]: source/Applications/Basic/FileFormats/ReadIterateZDF/ReadIterateZDF.cpp
[HandEyeCalibration-url]: source/Applications/Advanced/HandEyeCalibration
[HandEyeCalibrationSample-url]: source/Applications/Advanced/HandEyeCalibration/HandEyeCalibration/HandEyeCalibration.cpp
[UtilizeEyeInHandCalibration-url]: source/Applications/Advanced/HandEyeCalibration/UtilizeEyeInHandCalibration/UtilizeEyeInHandCalibration.cpp
[PoseConversions-url]: source/Applications/Advanced/HandEyeCalibration/PoseConversions/PoseConversions.cpp
[Downsample-url]: source/Applications/Advanced/Downsample/Downsample.cpp
[CaptureUndistortRGB-url]: source/Applications/Advanced/CaptureUndistortRGB/CaptureUndistortRGB.cpp
[CreateDepthMap-url]: source/Applications/Advanced/CreateDepthMap/CreateDepthMap.cpp
